{:title "aiderをC#プロジェクトで使う設定"
 :tags  ["aider" "C#"]
 :layout :post
 :toc true}

/editとか/lintとか/testが使えるようにする

## aiderのスラッシュコマンド
`/edit`:エディタでプロンプトを入力する。コンソール上で入力だと変換中に間違って送ってしまう。

`/lint`:リンターを実行。C#ならビルドに当たる。

`/test`:ユニットテストを実行。C#ならビルド＋テストに当たる。

## edit
C#なのでVisualStudioで編集したい。  
aider自身も、表示＞ターミナルからcmdかPowershell起動して実行できる。

起動引数で渡す `--editor "aider-edit-vs22.bat"`か、  
.aider.conf.ymlファイルに書く `editor: "aider-edit-vs22.bat"`  
batはパスが通ったとこに置いておくのがいい。  
.aider.conf.ymlは、homeのだと、VisualStudioとVSCodeと併用するときに不便なので、  
プロジェクトローカルの.aider.conf.ymlで設定するのがよさそう。

<script src="https://gist.github.com/fujimotok/5863d046503176dd26512b0ec24b2b88.js"></script>

## lint
ソリューション指定や構成指定があるので、  
プロジェクトローカルの.aider.conf.ymlファイルに書くのが良い。

`& @echo >nul` は、lint実行時にチャットにあるファイル一覧が渡されてきて、  
msbuild に無駄な引数が渡って、エラーになるのを回避するためにつけている。

```yml
lint-cmd: msbuild <ソリューション名>.sln /t:Build /p:Configuration=<構成> -nologo & @echo >nul
```

## test
テストのdllの指定があるので、  
プロジェクトローカルの.aider.conf.ymlファイルに書くのが良い。

lintと違い、testではファイル一覧が渡ってこないので、小細工は不要。

テスト実行前にビルドもしておく

```yml
test-cmd: msbuild <ソリューション名>.sln /t:Build /p:Configuration=<構成> & vstest.console path\to\test.dll
```

## まとめ
本気でaiderを開発に使うなら、/edit使って入力をしやすくする必要があるし、  
/lintと/testで壊さないように改良を続けることができそう。
